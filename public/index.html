<!doctype html>
<html lang="en">
  <head>
    <link rel="stylesheet" href="css/style.css">
    <meta charset="utf-8" />
    <title>WebGL Demo</title>
    <script src="index.js" type="module"></script>
    <script
      src="https://cdnjs.cloudflare.com/ajax/libs/gl-matrix/2.8.1/gl-matrix-min.js"
      integrity="sha512-zhHQR0/H5SEBL3Wn6yYSaTTZej12z0hVZKOv3TwCUXT1z5qeqGcXJLLrbERYRScEDDpYIJhPC1fk31gqR783iQ=="
      crossorigin="anonymous"
      defer></script>
      
  </head>

  <body id = "body">

    <div class="loading-box" id = "loadingBox">Loading World</div>

    <div id = "debugMenu">Hallo</div>
    <div id="topBarWrapper" class="top-bar-wrapper">
      <div id="topBar" class="top-bar">
        <button id="raytracing" class="toggle-button active">Raytracing</button>
        <button id="pathtracing" class="toggle-button">Path Tracing</button>
        <button id="menu-toggle" class="menu-button">☰</button>
      </div>
    </div>

    <div id="sidebar" class="sidebar">
      <h2>Sidebar Menu</h2>
      <p>Put settings or extra tools here.</p>
      <div class="bounce-slider-wrapper">
        <label for="bounceSlider">Adjust Value:</label>
        <input type="range" id="bounceSlider" min="0" max="15" value="10">
        <p class = "sliderInput">(Pathtracing) Number of Bounces: <span id="bounceValue">5</span></p>
      </div>
      <div id="ssao-controls" style="margin: 16px 0;">
        <label for="radius-slider">SSAO Radius: <span id="radius-value">5.0</span></label>
        <input type="range" id="radius-slider" min="0.1" max="10.0" step="0.01" value="5.0">
        <br>
        <label for="bias-slider">SSAO Bias: <span id="bias-value">0.025</span></label>
        <input type="range" id="bias-slider" min="0.0" max="11" step="0.001" value="0.025">
        <br>
        <label for="blur-checkbox">
          <input type="checkbox" id="blur-checkbox" checked>
          Enable SSAO Blur
        </label>

      </div>
      <div id="cloud-controls" style="margin: 16px 0;">
        <label for="density-slider">Cloud Density Threshold: <span id="density-value">0.5</span></label>
        <input type="range" id="density-slider" min="-2.0" max="1.0" step="0.01" value="0.5">
        <br>
        <label for="absorption-slider">Cloud Absorption: <span id="absorption-value">1.0</span></label>
        <input type="range" id="absorption-slider" min="0" max="2.0" step="0.01" value="1.0">
        <br>
        <label for="frequency-slider">Cloud Noise Frequency: <span id="frequency-value">0.2</span></label>
        <input type="range" id="frequency-slider" min="0.1" max="5.0" step="0.1" value="0.2">

      </div>
      <h3>World Objects</h3>
      <button id="open-popup-btn">Add World Object</button>
      <div id = "world-objects">

      </div>
    </div>
    </div>

    <div id="popup" class="popup hidden">
      <div class="popup-content">
        <span id="close-popup-btn" class="close">&times;</span>
        <h2>Add World Object</h2>

        <!-- Object Name -->
        <label>
          Object Name:
          <input type="text" id="object-name" />
        </label>
        <br/>

        <!-- File Upload -->
        <label>
          Upload .ply, .3mf, or .obj file:
          <input type="file" id="ply-file" accept=".ply, .3mf, .obj" />
          <br/>
          Note: We only support .ply files in ASCII format for now.
        </label>
        <br/>

        <!-- Import Map Section -->
        <h3>Import Map</h3>
        <div id="import-map"></div>
        <div style="display: inline-flex; align-items: center; gap: 6px;">
          <button id="add-map-entry">+ Add Mapping</button>
          <div class="tooltip-container">
            <span class="help-tooltip">?</span>
            <div class="tooltip-box">
                <p><b>Material Mapping</b> basically means a color corresponds to a custom material type, to which you can edit. If no map for that specific color is provided, a new diffuse surface is created.</p>
                <p>Each material type has different properties and appearance.</p>
                <p><u>These are the types currently supported:</u></p>
                <ul>
                  <li>Diffuse (Lambertian): Matte surface</li>
                  <li>Specular (Perfect Mirror) – color ignored</li>
                  <li>Glossy (Microfacet Reflection)<br>(roughness 0=mirror, 1=diffuse)</li>
                  <li>Transmission (Glass/Dielectric)<br>(roughness ~ index of refraction)</li>
                  <li>Emission: Emissive surface</li>
                </ul>
            </div>
          </div>
        </div>


        <br/><br/>
        <button id="submit-object">Submit</button>
      </div>
    </div>
    <canvas id="#MainCanvas" width="500" height="500"></canvas>
    <style src="css/style.css"></style>
  </body>
</html>